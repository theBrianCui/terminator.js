"use strict";var Terminator=function(){var e={append:function(e,t){for(var n=0;n<t.length;n++)e.appendChild(t[n]);return e}},t=function(e,t){var n=this;this.config={alwaysFocus:!0,autoScroll:!0,prefix:"~$",caret:"_"};for(var i in t)t.hasOwnProperty(i)&&this.config.hasOwnProperty(i)&&(this.config[i]=t[i]);var o=document.createElement("input");o.setAttribute("type","text"),o.classList.add("terminator-hidden"),document.body.appendChild(o),this.element=e,this.hiddenField=o,this.displayField=null,this.activeCaret=null,this.callback=!1,this.locked=!1,o.addEventListener("input",function(){console.log("Typing!"),n.displayField&&!n.locked&&(window.scrollTo(0,document.body.scrollHeight),n.displayField.textContent=n.hiddenField.value)}),o.addEventListener("keydown",function(e){return 37==e.key||37==e.keyCode||39==e.key||39==e.keyCode?void e.preventDefault():void(13!=e.key&&13!=e.keyCode||n.locked||(console.log("Enter key pressed!"),window.scrollTo(0,document.body.scrollHeight),n.run(n.displayField.textContent)))}),this.config.alwaysFocus&&o.addEventListener("blur",function(){setTimeout(function(){var e=window.scrollX,t=window.scrollY;n.hiddenField.focus(),window.scrollTo(e,t)},0)},!0);var l={};this.register=function(e,t){if(Array.isArray(t))for(var n=0;n<t.length;n++)l[t[n]]=e;else l[t]=e},this.canExecute=function(e){return e&&l[e]},this.execute=function(e,t){return l[e](this,t)}};return t.prototype.writeLine=function(e){var t=document.createElement("span");return t.textContent=e,this.element.appendChild(t),this.lineBreak(),t},t.prototype.writeHTML=function(e){var t=document.createElement("div");return t.innerHTML=e,this.element.appendChild(t),t},t.prototype.lineBreak=function(){var e=document.createElement("br");this.element.appendChild(e)},t.prototype.run=function(e){if(this.locked=!0,this.activeCaret.style.display="none",this.activeCaret=null,!e)return void this.prompt();if(this.callback)return this.callback(this,e),this.callback=null,void(this.config.autoScroll&&window.scrollTo(0,document.body.scrollHeight));console.log("No callback for command: "+e);var t=e.split(" ");this.canExecute(t[0])?(console.log("Running registered program "+t[0]),this.execute(t[0],e),this.config.autoScroll&&window.scrollTo(0,document.body.scrollHeight)):(console.warn("Invalid command: "+e),this.writeLine(e+": command not found"),this.prompt())},t.prototype.autoType=function(e,t){var n=this;if(this.locked)console.warn("Terminal currently locked, cannot auto-type command: "+e);else{this.locked=!0,this.displayField.textContent="",t=t||0;for(var i=[],o=0;o<e.length;o++)i[o]=function(t){var n=this;return function(){n.displayField.textContent+=e[t]}}.call(this,o);for(var l=0;l<e.length;l++)setTimeout(i[l],50*l+t);setTimeout(function(){n.run(n.displayField.textContent)},50*e.length+100+t)}},t.prototype.prompt=function(t,n){var i=this;this.hiddenField.value="";var o=document.createElement("div");o.addEventListener("click",function(){i.hiddenField.focus(),window.scrollTo(0,document.body.scrollHeight)});var l=document.createElement("span");l.innerHTML=t||this.config.prefix;var r=document.createElement("span"),c=document.createElement("span");c.textContent=this.config.caret,c.classList.add("terminator-blink"),e.append(o,[l,r,c]),this.element.appendChild(o),this.displayField=r,this.activeCaret=c,this.callback=n||null,this.locked=!1,this.hiddenField.focus(),this.config.autoScroll&&window.scrollTo(0,document.body.scrollHeight)},t}();